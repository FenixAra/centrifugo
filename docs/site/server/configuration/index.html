



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Centrifugo Documentation">
      
      
        <link rel="canonical" href="https://github.com/centrifugal/centrifugo/server/configuration/">
      
      
        <meta name="author" content="Centrifugal">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/logo.png">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.6.6">
    
    
      
        <title>Configuration - Centrifugo Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../theme/styles/extra.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="cyan">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#configuration" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://github.com/centrifugal/centrifugo" title="Centrifugo Documentation" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Centrifugo Documentation
              </span>
              <span class="md-header-nav__topic">
                Configuration
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/centrifugal/centrifugo/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      centrifugal/centrifugo
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/logo.png" width="24" height="24">
      
    </span>
    Centrifugo Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/centrifugal/centrifugo/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      centrifugal/centrifugo
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../concepts/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Server
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Server
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Configuration
      </label>
    
    <a href="./" title="Configuration" class="md-nav__link md-nav__link--active">
      Configuration
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#version" title="version" class="md-nav__link">
    version
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#json-file" title="JSON file" class="md-nav__link">
    JSON file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toml-file" title="TOML file" class="md-nav__link">
    TOML file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#yaml-file" title="YAML file" class="md-nav__link">
    YAML file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#checkconfig-command" title="checkconfig command" class="md-nav__link">
    checkconfig command
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genconfig-command" title="genconfig command" class="md-nav__link">
    genconfig command
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#important-options" title="Important options" class="md-nav__link">
    Important options
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channel-options" title="Channel options" class="md-nav__link">
    Channel options
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-configuration" title="Advanced configuration" class="md-nav__link">
    Advanced configuration
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#client_channel_limit" title="client_channel_limit" class="md-nav__link">
    client_channel_limit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel_max_length" title="channel_max_length" class="md-nav__link">
    channel_max_length
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel_user_connection_limit" title="channel_user_connection_limit" class="md-nav__link">
    channel_user_connection_limit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client_request_max_size" title="client_request_max_size" class="md-nav__link">
    client_request_max_size
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client_queue_max_size" title="client_queue_max_size" class="md-nav__link">
    client_queue_max_size
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sockjs_heartbeat_delay" title="sockjs_heartbeat_delay" class="md-nav__link">
    sockjs_heartbeat_delay
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#websocket_compression" title="websocket_compression" class="md-nav__link">
    websocket_compression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gomaxprocs" title="gomaxprocs" class="md-nav__link">
    gomaxprocs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-endpoint-configuration" title="Advanced endpoint configuration." class="md-nav__link">
    Advanced endpoint configuration.
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-endpoints" title="Default endpoints." class="md-nav__link">
    Default endpoints.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#admin-endpoints" title="Admin endpoints." class="md-nav__link">
    Admin endpoints.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debug-endpoints" title="Debug endpoints." class="md-nav__link">
    Debug endpoints.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-admin-and-api-ports" title="Custom admin and API ports" class="md-nav__link">
    Custom admin and API ports
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../admin/" title="Admin web interface" class="md-nav__link">
      Admin web interface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../protocol/" title="Client protocol" class="md-nav__link">
      Client protocol
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Libraries
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Libraries
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../libraries/client/" title="Client libraries" class="md-nav__link">
      Client libraries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../libraries/api/" title="API libraries" class="md-nav__link">
      API libraries
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Deploy
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Deploy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/packages/" title="RPM and DEB packages" class="md-nav__link">
      RPM and DEB packages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/docker/" title="Docker image" class="md-nav__link">
      Docker image
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/nginx/" title="Nginx configuration" class="md-nav__link">
      Nginx configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/tls/" title="TLS" class="md-nav__link">
      TLS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/redis/" title="Redis HA" class="md-nav__link">
      Redis HA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/tuning/" title="OS tuning" class="md-nav__link">
      OS tuning
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#version" title="version" class="md-nav__link">
    version
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#json-file" title="JSON file" class="md-nav__link">
    JSON file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toml-file" title="TOML file" class="md-nav__link">
    TOML file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#yaml-file" title="YAML file" class="md-nav__link">
    YAML file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#checkconfig-command" title="checkconfig command" class="md-nav__link">
    checkconfig command
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#genconfig-command" title="genconfig command" class="md-nav__link">
    genconfig command
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#important-options" title="Important options" class="md-nav__link">
    Important options
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#channel-options" title="Channel options" class="md-nav__link">
    Channel options
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-configuration" title="Advanced configuration" class="md-nav__link">
    Advanced configuration
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#client_channel_limit" title="client_channel_limit" class="md-nav__link">
    client_channel_limit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel_max_length" title="channel_max_length" class="md-nav__link">
    channel_max_length
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channel_user_connection_limit" title="channel_user_connection_limit" class="md-nav__link">
    channel_user_connection_limit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client_request_max_size" title="client_request_max_size" class="md-nav__link">
    client_request_max_size
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client_queue_max_size" title="client_queue_max_size" class="md-nav__link">
    client_queue_max_size
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sockjs_heartbeat_delay" title="sockjs_heartbeat_delay" class="md-nav__link">
    sockjs_heartbeat_delay
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#websocket_compression" title="websocket_compression" class="md-nav__link">
    websocket_compression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gomaxprocs" title="gomaxprocs" class="md-nav__link">
    gomaxprocs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-endpoint-configuration" title="Advanced endpoint configuration." class="md-nav__link">
    Advanced endpoint configuration.
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-endpoints" title="Default endpoints." class="md-nav__link">
    Default endpoints.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#admin-endpoints" title="Admin endpoints." class="md-nav__link">
    Admin endpoints.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debug-endpoints" title="Debug endpoints." class="md-nav__link">
    Debug endpoints.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-admin-and-api-ports" title="Custom admin and API ports" class="md-nav__link">
    Custom admin and API ports
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/centrifugal/documentation/edit/master/docs/server/configuration.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">&para;</a></h1>
<p>Centrifugo expects JSON, TOML or YAML as format of configuration file. Thanks to brilliant Go library for application configuration - <a href="https://github.com/spf13/viper">viper</a>.</p>
<p>But first let's inspect all available command-line options:</p>
<div class="codehilite"><pre><span></span>centrifugo -h
</pre></div>

<p>You should see something like this as output:</p>
<div class="codehilite"><pre><span></span>Centrifugo – real-time messaging server

Usage:
   [flags]
   [command]

Available Commands:
  checkconfig Check configuration file
  genconfig   Generate simple configuration file to start with
  help        Help about any command
  version     Centrifugo version number

Flags:
  -a, --address string             interface address to listen on
      --admin                      enable admin web interface
      --admin_insecure             use insecure admin mode – no auth required for admin socket
      --api_insecure               use insecure API mode
      --client_insecure            start in insecure client mode
  -c, --config string              path to config file (default &quot;config.json&quot;)
      --debug                      enable debug endpoints
  -e, --engine string              engine to use: memory or redis (default &quot;memory&quot;)
      --grpc_api                   enable GRPC API server
      --grpc_client                enable GRPC client server
  -h, --help                       help for this command
      --internal_port string       custom port for internal endpoints
      --log_file string            optional log file - if not specified logs go to STDOUT
      --log_level string           set the log level: debug, info, error, fatal or none (default &quot;info&quot;)
  -n, --name string                unique node name
      --pid_file string            optional path to create PID file
  -p, --port string                port to bind HTTP server to (default &quot;8000&quot;)
      --prometheus                 enable Prometheus metrics endpoint
      --redis_db string            Redis database (Redis engine) (default &quot;0&quot;)
      --redis_host string          Redis host (Redis engine) (default &quot;127.0.0.1&quot;)
      --redis_master_name string   name of Redis master Sentinel monitors (Redis engine)
      --redis_password string      Redis auth password (Redis engine)
      --redis_pool int             Redis pool size (Redis engine) (default 256)
      --redis_port string          Redis port (Redis engine) (default &quot;6379&quot;)
      --redis_sentinels string     comma-separated list of Sentinel addresses (Redis engine)
      --redis_url string           Redis connection URL in format redis://:password@hostname:port/db (Redis engine)
      --tls                        enable TLS, requires an X509 certificate and a key file
      --tls_cert string            path to an X509 certificate file
      --tls_key string             path to an X509 certificate key

Use &quot; [command] --help&quot; for more information about a command.
</pre></div>

<h3 id="version">version<a class="headerlink" href="#version" title="Permanent link">&para;</a></h3>
<p>To show version and exit run:</p>
<div class="codehilite"><pre><span></span>centrifugo version
</pre></div>

<h3 id="json-file">JSON file<a class="headerlink" href="#json-file" title="Permanent link">&para;</a></h3>
<p>Centrifugo requires configuration file on start. As was mentioned earlier it must be a file with valid JSON.</p>
<p>This is a minimal Centrifugo configuration file:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;secret&quot;</span><span class="o">:</span> <span class="s2">&quot;secret&quot;</span>
<span class="p">}</span>
</pre></div>

<p>The only field that is required is <strong>secret</strong>. Secret used to create HMAC signs. Keep it strong and in secret!</p>
<h3 id="toml-file">TOML file<a class="headerlink" href="#toml-file" title="Permanent link">&para;</a></h3>
<p>Centrifugo also supports TOML format for configuration file:</p>
<div class="codehilite"><pre><span></span>centrifugo --config=config.toml
</pre></div>

<p>Where <code class="codehilite">config.toml</code> contains:</p>
<div class="codehilite"><pre><span></span>secret = &quot;secret&quot;
log_level = &quot;debug&quot;
</pre></div>

<p>I.e. the same configuration as JSON file above. We will talk about what is <code class="codehilite">namespaces</code> field soon.</p>
<h3 id="yaml-file">YAML file<a class="headerlink" href="#yaml-file" title="Permanent link">&para;</a></h3>
<p>And YAML config also supported. <code class="codehilite">config.yaml</code>:</p>
<div class="codehilite"><pre><span></span><span class="n">secret</span><span class="o">:</span> <span class="n">secret</span>
<span class="n">log_level</span><span class="o">:</span> <span class="n">debug</span>
</pre></div>

<p>With YAML remember to use spaces, not tabs when writing configuration file.</p>
<h3 id="checkconfig-command">checkconfig command<a class="headerlink" href="#checkconfig-command" title="Permanent link">&para;</a></h3>
<p>Centrifugo has special command to check configuration file <code class="codehilite">checkconfig</code>:</p>
<div class="codehilite"><pre><span></span>centrifugo checkconfig --config<span class="o">=</span>config.json
</pre></div>

<p>If any errors found during validation – program will exit with error message and exit code 1.</p>
<h3 id="genconfig-command">genconfig command<a class="headerlink" href="#genconfig-command" title="Permanent link">&para;</a></h3>
<p>Another command is <code class="codehilite">genconfig</code>:</p>
<div class="codehilite"><pre><span></span>centrifugo genconfig -c config.json
</pre></div>

<p>It will generate the minimal required configuration file automatically.</p>
<h3 id="important-options">Important options<a class="headerlink" href="#important-options" title="Permanent link">&para;</a></h3>
<p>Some of the most important options you can configure when running Centrifugo:</p>
<ul>
<li><code class="codehilite">address</code> – bind your Centrifugo to specific interface address (by default <code class="codehilite">&quot;&quot;</code>)</li>
<li><code class="codehilite">port</code> – port to bind Centrifugo to (by default <code class="codehilite">8000</code>)</li>
<li><code class="codehilite">engine</code> – engine to use - <code class="codehilite">memory</code> or <code class="codehilite">redis</code> (by default <code class="codehilite">memory</code>). Read more about engines in next sections.</li>
</ul>
<p>Note that some options can be set via command-line. Command-line options are more valuable when set than configuration file's options. See description of <a href="https://github.com/spf13/viper">viper</a> – to see more details about configuration options priority.</p>
<h3 id="channel-options">Channel options<a class="headerlink" href="#channel-options" title="Permanent link">&para;</a></h3>
<p>Let's look on options related to channels. Channel is an entity to which clients can subscribe to receive messages published into that channel. Channel is just a string (several symbols has special meaning in Centrifugo - see special chapter to find more information about channels). The following options will affect channel behaviour:</p>
<ul>
<li>
<p><code class="codehilite">publish</code> – allow clients to publish messages into channels directly (from client side). Your application will never receive those messages. In idiomatic case all messages must be published by your application backend using Centrifugo API. But this option can be useful when you want to build something without backend-side validation and saving into database. This option can also be useful for demos and prototyping real-time ideas. Note that client can only publish data into channel after successfully subscribed on it. By default it's <code class="codehilite">false</code>.</p>
</li>
<li>
<p><code class="codehilite">anonymous</code> – this option enables anonymous access (with empty user ID in connection parameters). In most situations your application works with authorized users so every user has its own unique id. But if you provide real-time features for public access you may need unauthorized access to some channels. Turn on this option and use empty string as user ID. By default <code class="codehilite">false</code>.</p>
</li>
<li>
<p><code class="codehilite">presence</code> – enable/disable presence information. Presence is a structure with clients currently subscribed on channel. By default <code class="codehilite">false</code> – i.e. no presence information available for channels.</p>
</li>
<li>
<p><code class="codehilite">join_leave</code> – enable/disable sending join(leave) messages when client subscribes on channel (unsubscribes from channel). By default <code class="codehilite">false</code>.</p>
</li>
<li>
<p><code class="codehilite">history_size</code> – history size (amount of messages) for channels. As Centrifugo keeps all history messages in memory it's very important to limit maximum amount of messages in channel history to reasonable minimum. By default history size is <code class="codehilite">0</code> - this means that channels will have no history messages at all. As soon as history enabled then <code class="codehilite">history_size</code> defines maximum amount of messages that Centrifugo will keep for <strong>each</strong> channel in namespace during history lifetime (see below).</p>
</li>
<li>
<p><code class="codehilite">history_lifetime</code> – interval in seconds how long to keep channel history messages. As all history is storing in memory it is also very important to get rid of old history data for unused (inactive for a long time) channels. By default history lifetime is <code class="codehilite">0</code> – this means that channels will have no history messages at all. <strong>So to get history messages you should wisely configure both <code class="codehilite">history_size</code> and <code class="codehilite">history_lifetime</code> options</strong>.</p>
</li>
<li>
<p><code class="codehilite">history_recover</code> (<strong>new in v1.2.0</strong>) – boolean option, when enabled Centrifugo will try to recover missed messages published while client was disconnected for some reason (bad internet connection for example). By default <code class="codehilite">false</code>. This option must be used in conjunction with reasonably configured message history for channel i.e. <code class="codehilite">history_size</code> and <code class="codehilite">history_lifetime</code> <strong>must be set</strong> (because Centrifugo uses channel message history to recover messages). Also note that note all real-time events require this feature turned on so think wisely when you need this. See more details about how this option works in <a href="recover.md">special chapter</a>.</p>
</li>
<li>
<p><code class="codehilite">history_drop_inactive</code> (<strong>new in v1.3.0</strong>) – boolean option, allows to drastically reduce resource usage (engine memory usage, messages travelling around) when you use message history for channels. In couple of words when enabled Centrifugo will drop history messages that no one needs. Please, see <a href="https://github.com/centrifugal/centrifugo/issues/50">issue on Github</a> to get more information about option use case scenario and edge cases it involves.</p>
</li>
</ul>
<p>Let's look how to set some of these options in config:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;secret&quot;</span><span class="o">:</span> <span class="s2">&quot;my-secret-key&quot;</span><span class="p">,</span>
    <span class="s2">&quot;anonymous&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">&quot;publish&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">&quot;presence&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">&quot;join_leave&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">&quot;history_size&quot;</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;history_lifetime&quot;</span><span class="o">:</span> <span class="mi">30</span><span class="p">,</span>
    <span class="s2">&quot;history_recover&quot;</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">}</span>
</pre></div>

<p>And the last channel specific option is <code class="codehilite">namespaces</code>. <code class="codehilite">namespaces</code> are optional and if set must be an array of namespace objects. Namespace allows to configure custom options for channels starting with namespace name. This provides a great control over channel behaviour.</p>
<p>Namespace has a name and the same channel options (with same defaults) as described above.</p>
<ul>
<li><code class="codehilite">name</code> - unique namespace name (name must must consist of letters, numbers, underscores or hyphens and be more than 2 symbols length i.e. satisfy regexp <code class="codehilite">^[-a-zA-Z0-9_]{2,}$</code>).</li>
</ul>
<p>If you want to use namespace options for channel - you must include namespace name into
channel name with <code class="codehilite">:</code> as separator:</p>
<p><code class="codehilite"><span class="kd">public</span><span class="o">:</span><span class="n">messages</span></code></p>
<p><code class="codehilite"><span class="n">gossips</span><span class="o">:</span><span class="n">messages</span></code></p>
<p>Where <code class="codehilite">public</code> and <code class="codehilite">gossips</code> are namespace names from project <code class="codehilite">namespaces</code>.</p>
<p>All things together here is an example of <code class="codehilite">config.json</code> which includes registered project with all options set and 2 additional namespaces in it:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;secret&quot;</span><span class="o">:</span> <span class="s2">&quot;very-long-secret-key&quot;</span><span class="p">,</span>
    <span class="s2">&quot;anonymous&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">&quot;publish&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">&quot;presence&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">&quot;join_leave&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">&quot;history_size&quot;</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;history_lifetime&quot;</span><span class="o">:</span> <span class="mi">30</span><span class="p">,</span>
    <span class="s2">&quot;namespaces&quot;</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;public&quot;</span><span class="p">,</span>
          <span class="s2">&quot;publish&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
          <span class="s2">&quot;anonymous&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
          <span class="s2">&quot;history_size&quot;</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
          <span class="s2">&quot;history_lifetime&quot;</span><span class="o">:</span> <span class="mi">30</span><span class="p">,</span>
          <span class="s2">&quot;history_recover&quot;</span><span class="o">:</span> <span class="kc">true</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;gossips&quot;</span><span class="p">,</span>
          <span class="s2">&quot;presence&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
          <span class="s2">&quot;join_leave&quot;</span><span class="o">:</span> <span class="kc">true</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>

<p>Channel <code class="codehilite">news</code> will use global project options.</p>
<p>Channel <code class="codehilite"><span class="kd">public</span><span class="o">:</span><span class="n">news</span></code> will use <code class="codehilite">public</code> namespace's options.</p>
<p>Channel <code class="codehilite"><span class="n">gossips</span><span class="o">:</span><span class="n">news</span></code> will use <code class="codehilite">gossips</code> namespace's options.</p>
<h3 id="advanced-configuration">Advanced configuration<a class="headerlink" href="#advanced-configuration" title="Permanent link">&para;</a></h3>
<p>Centrifugo has some options for which default values make sense for most applications. In many case you
don't need (and you really should not) change them. This chapter is about such options.</p>
<h4 id="client_channel_limit">client_channel_limit<a class="headerlink" href="#client_channel_limit" title="Permanent link">&para;</a></h4>
<p>Default: 128</p>
<p>Sets maximum number of different channel subscriptions single client can have.</p>
<h4 id="channel_max_length">channel_max_length<a class="headerlink" href="#channel_max_length" title="Permanent link">&para;</a></h4>
<p>Default: 255</p>
<p>Sets maximum length of channel name.</p>
<h4 id="channel_user_connection_limit">channel_user_connection_limit<a class="headerlink" href="#channel_user_connection_limit" title="Permanent link">&para;</a></h4>
<p>Default: 0</p>
<p>Maximum number of connections from user (with known user ID) to Centrifugo node. By default - unlimited.</p>
<h4 id="client_request_max_size">client_request_max_size<a class="headerlink" href="#client_request_max_size" title="Permanent link">&para;</a></h4>
<p>Default: 65536</p>
<p>Maximum allowed size of request from client in bytes.</p>
<h4 id="client_queue_max_size">client_queue_max_size<a class="headerlink" href="#client_queue_max_size" title="Permanent link">&para;</a></h4>
<p>Default: 10485760</p>
<p>Maximum client message queue size in bytes to close slow reader connections. By default - 10mb.</p>
<h4 id="sockjs_heartbeat_delay">sockjs_heartbeat_delay<a class="headerlink" href="#sockjs_heartbeat_delay" title="Permanent link">&para;</a></h4>
<p>Default: 25</p>
<p>Interval in seconds how often to send SockJS h-frames to client.</p>
<h4 id="websocket_compression">websocket_compression<a class="headerlink" href="#websocket_compression" title="Permanent link">&para;</a></h4>
<p>Default: false</p>
<p>Enable websocket compression, see special chapter in docs.</p>
<h4 id="gomaxprocs">gomaxprocs<a class="headerlink" href="#gomaxprocs" title="Permanent link">&para;</a></h4>
<p>Default: 0</p>
<p>By default Centrifugo runs on all available CPU cores. If you want to limit amount of cores Centrifugo can utilize in one moment use this option.</p>
<h3 id="advanced-endpoint-configuration">Advanced endpoint configuration.<a class="headerlink" href="#advanced-endpoint-configuration" title="Permanent link">&para;</a></h3>
<p>After you started Centrifugo you have several endpoints available. As soon as you have not provided any extra options you have 3 endpoints by default.</p>
<h4 id="default-endpoints">Default endpoints.<a class="headerlink" href="#default-endpoints" title="Permanent link">&para;</a></h4>
<p>First is SockJS endpoint - it's needed to serve client connections that use SockJS library:</p>
<div class="codehilite"><pre><span></span>http://localhost:8000/connection/sockjs
</pre></div>

<p>Next is raw Websocket endpoint to serve client connections that use pure Websocket protocol:</p>
<div class="codehilite"><pre><span></span>ws://localhost:8000/connection/websocket
</pre></div>

<p>And finally you have API endpoint to <code class="codehilite">publish</code> messages to channels (and execute other available API commands):</p>
<div class="codehilite"><pre><span></span>http://localhost:8000/api
</pre></div>

<p>By default all endpoints work on port <code class="codehilite">8000</code>. You can change it using <code class="codehilite">port</code> option:</p>
<div class="codehilite"><pre><span></span>{
    &quot;port&quot;: 9000
}
</pre></div>

<p>In production setup you will have your domain name in endpoint addresses above instead of <code class="codehilite">localhost</code>. Also if your Centrifugo will be behind proxy or load balancer software you most probably won't have ports in your endpoint addresses. What will always be the same as shown above are URL paths: <code class="codehilite">/connection/sockjs</code>, <code class="codehilite">/connection/websocket</code>, <code class="codehilite">/api</code>.</p>
<p>Let's look at possibilities to tweak available endpoints.</p>
<h4 id="admin-endpoints">Admin endpoints.<a class="headerlink" href="#admin-endpoints" title="Permanent link">&para;</a></h4>
<p>First is enabling admin endpoints:</p>
<div class="codehilite"><pre><span></span>{
    ...
    &quot;admin&quot;: true,
    &quot;admin_password&quot;: &quot;password&quot;,
    &quot;admin_secret&quot;: &quot;secret&quot;
}
</pre></div>

<p>This makes the following endpoint available:</p>
<div class="codehilite"><pre><span></span>ws://localhost:8000
</pre></div>

<p>At this address you will see embedded admin web interface. You can log into it using <code class="codehilite">admin_password</code> value shown above.</p>
<h4 id="debug-endpoints">Debug endpoints.<a class="headerlink" href="#debug-endpoints" title="Permanent link">&para;</a></h4>
<p>Next, when Centrifugo started in debug mode some extra debug endpoints become available. To start in debug mode add <code class="codehilite">debug</code> option to config:</p>
<div class="codehilite"><pre><span></span>{
    ...
    &quot;debug&quot;: true
}
</pre></div>

<p>And endpoint:</p>
<div class="codehilite"><pre><span></span>http://localhost:8000/debug/pprof/
</pre></div>

<p>– will show you useful info about internal state of Centrifugo instance. This info is especially helpful when troubleshooting.</p>
<h4 id="custom-admin-and-api-ports">Custom admin and API ports<a class="headerlink" href="#custom-admin-and-api-ports" title="Permanent link">&para;</a></h4>
<p>We strongly recommend to not expose admin, debug and API endpoints to Internet. In case of admin endpoint this step provides extra protection to <code class="codehilite">/</code>, <code class="codehilite">/admin/auth</code>, <code class="codehilite">/admin/api</code> endpoints, debug endpoints. Protecting API endpoint will allow you to use <code class="codehilite">api_insecure</code> mode to omit passing API key in each request.</p>
<p>So it's a good practice to protect admin and API endpoints with firewall. For example you can do this in <code class="codehilite">location</code> section of Nginx configuration.</p>
<p>Though sometimes you don't have access to per-location configuration in your proxy/load balancer software. For example
when using Amazon ELB. In this case you can change ports on which your admin and API endpoints work.</p>
<p>To run admin endpoints on custom port use <code class="codehilite">admin_port</code> option:</p>
<div class="codehilite"><pre><span></span>{
    ...
    &quot;admin_port&quot;: 10000
}
</pre></div>

<p>So admin web interface will work on address:</p>
<div class="codehilite"><pre><span></span>ws://localhost:10000
</pre></div>

<p>Also debug page will be available on new custom admin port too:</p>
<div class="codehilite"><pre><span></span>http://localhost:10000/debug/pprof/
</pre></div>

<p>To run API server on it's own port use <code class="codehilite">api_port</code> option:</p>
<div class="codehilite"><pre><span></span>{
    ...
    &quot;api_port&quot;: 10001
}
</pre></div>

<p>Now you should send API requests to:</p>
<div class="codehilite"><pre><span></span>http://localhost:10001/api
</pre></div>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../install/" title="Installation" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Installation
              </span>
            </div>
          </a>
        
        
          <a href="../admin/" title="Admin web interface" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Admin web interface
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.02434462.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>